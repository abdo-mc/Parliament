<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>عرض بيانات العضو</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      margin: 0;
      background: #f0f4f8;
      color: #222;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      box-sizing: border-box;
    }
    .container {
      background: white;
      max-width: 700px;
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      padding: 30px 40px;
      display: flex;
      gap: 30px;
      align-items: center;
      flex-wrap: wrap;
      direction: rtl;
    }
    .photo {
      flex-shrink: 0;
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: #ddd;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0,82,155,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .info {
      flex: 1;
      min-width: 280px;
    }
    .info h2 {
      margin: 0 0 10px 0;
      color: #00529b;
      font-weight: 700;
      font-size: 1.8rem;
    }
    .info .field {
      margin-bottom: 12px;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .field label {
      font-weight: 600;
      min-width: 130px;
      color: #007bff;
    }
    .field a {
      color: #00529b;
      text-decoration: none;
      word-break: break-all;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: color 0.3s ease;
    }
    .field a:hover {
      color: #004a8b;
      text-decoration: underline;
    }
    .icon {
      width: 18px;
      height: 18px;
      fill: #00529b;
    }
    .loading {
      font-size: 1.3rem;
      color: #00529b;
      font-weight: 700;
      text-align: center;
      width: 100%;
    }
    .error {
      font-size: 1.3rem;
      color: #cc0000;
      font-weight: 700;
      text-align: center;
      width: 100%;
    }
  </style>
</head>
<body>

<div class="container" id="container" style="display:none;">
  <div class="photo" id="photo">
    <img src="https://via.placeholder.com/120?text=No+Image" alt="صورة العضو" />
  </div>
  <div class="info" id="info">
    <!-- بيانات العضو هتظهر هنا -->
  </div>
</div>

<div class="loading" id="loading">جاري تحميل البيانات...</div>
<div class="error" id="error" style="display:none;"></div>

<script>
  // قراءة كود العضو من رابط URL
  function getIdFromURL() {
    const params = new URLSearchParams(window.location.search);
    return params.get('id') || '';
  }

  // أيقونات SVG للروابط (تليفون، واتساب، سوشيال ميديا)
  const icons = {
    phone: `<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.11-.21c1.21.49 2.53.76 3.88.76a1 1 0 011 1v3.5a1 1 0 01-1 1C7.16 21.5 2.5 16.84 2.5 11a1 1 0 011-1h3.5a1 1 0 011 1c0 1.35.27 2.67.76 3.88a1 1 0 01-.21 1.11l-2.2 2.2z"/></svg>`,
    whatsapp: `<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.52 3.48A11.927 11.927 0 0012 0C5.373 0 0 5.373 0 12a11.927 11.927 0 001.75 6.28L0 24l5.76-1.68A11.9 11.9 0 0012 24c6.627 0 12-5.373 12-12 0-3.19-1.24-6.2-3.48-8.52zM12 21.3a9.29 9.29 0 01-4.92-1.43l-.35-.21-3.44 1 1-3.35-.23-.35A9.27 9.27 0 012.7 12c0-5.03 4.09-9.12 9.12-9.12 2.44 0 4.72.95 6.44 2.68a9.03 9.03 0 012.7 6.44c0 5.03-4.09 9.12-9.12 9.12z"/><path d="M17.06 14.5c-.23-.12-1.36-.67-1.57-.75-.21-.08-.37-.12-.53.12-.15.23-.6.75-.73.9-.13.15-.27.17-.5.06-.23-.12-1- .37-1.9-1.16-.7-.62-1.17-1.39-1.31-1.62-.13-.23-.01-.35.1-.47.1-.11.23-.28.34-.42.11-.14.15-.23.23-.38.08-.15.04-.28-.02-.4-.06-.12-.53-1.27-.73-1.73-.19-.46-.39-.4-.53-.4-.14 0-.3-.02-.45-.02-.15 0-.4.06-.6.28-.2.22-.77.75-.77 1.83 0 1.08.79 2.12.9 2.27.12.15 1.56 2.38 3.77 3.34.53.23.94.37 1.26.47.53.15 1.02.13 1.4.08.43-.06 1.36-.55 1.55-1.08.18-.53.18-.98.13-1.07-.06-.09-.21-.15-.45-.27z"/></svg>`,
    social: `<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69a4.3 4.3 0 001.89-2.37 8.6 8.6 0 01-2.72 1.04 4.28 4.28 0 00-7.3 3.9A12.13 12.13 0 013 4.91a4.28 4.28 0 001.32 5.7 4.26 4.26 0 01-1.94-.54v.05a4.28 4.28 0 003.44 4.2 4.3 4.3 0 01-1.93.07 4.28 4.28 0 004 2.97 8.6 8.6 0 01-5.33 1.84A8.74 8.74 0 012 19.54a12.1 12.1 0 006.56 1.92c7.87 0 12.18-6.52 12.18-12.17 0-.19 0-.38-.01-.57A8.72 8.72 0 0024 5.54a8.57 8.57 0 01-2.54.7z"/></svg>`
  };

  async function fetchMemberData(id) {
    const url = `https://script.google.com/macros/s/AKfycby5tLE8HTUtiQ8Qj99y9Veqt85LIi4eIMCIeTxESHvohpxZm7LTGAn-gUsMdrbCCfUY/exec?id=${encodeURIComponent(id)}`;
    try {
      const res = await fetch(url);
      if (!res.ok) throw new Error("فشل تحميل البيانات");
      const data = await res.json();
      return data;
    } catch (err) {
      throw err;
    }
  }

  function createLink(url, text, iconSvg) {
    if (!url) return '-';
    return `<a href="${url}" target="_blank" rel="noopener noreferrer">${iconSvg} ${text}</a>`;
  }

  function renderMember(data) {
    const photoUrl = data.PIC || 'https://via.placeholder.com/120?text=No+Image';
    document.getElementById('photo').innerHTML = `<img src="${photoUrl}" alt="صورة العضو" />`;

    const infoDiv = document.getElementById('info');
    infoDiv.innerHTML = `
      <h2>${data.Name || '-'}</h2>
      <div class="field"><label>الكود:</label><span>${data.Code || '-'}</span></div>
      <div class="field"><label>الدولة:</label><span>${data.Country || '-'}</span></div>
      <div class="field"><label>فيسبوك:</label>${createLink(data.Social || '', data.Social || '-', icons.social)}</div>
      <div class="field"><label>التليفون:</label>${createLink('tel:' + data.Phone, data.Phone || '-', icons.phone)}</div>
      <div class="field"><label>واتساب:</label>${createLink('https://wa.me/' + data.Whatsapp, data.Whatsapp || '-', icons.whatsapp)}</div>
      <div class="field"><label>ملاحظات أخرى:</label><span>${data.Other || '-'}</span></div>
    `;
  }

  async function main() {
    const id = getIdFromURL();
    if (!id) {
      document.getElementById('loading').style.display = 'none';
      const errDiv = document.getElementById('error');
      errDiv.textContent = 'لا يوجد كود عضوية في الرابط.';
      errDiv.style.display = 'block';
      return;
    }

    try {
      const data = await fetchMemberData(id);
      document.getElementById('loading').style.display = 'none';
      if (!data || !data.Code) {
        const errDiv = document.getElementById('error');
        errDiv.textContent = 'لا توجد بيانات لهذا الكود.';
        errDiv.style.display = 'block';
        return;
      }
      renderMember(data);
      document.getElementById('container').style.display = 'flex';
    } catch (e) {
      document.getElementById('loading').style.display = 'none';
      const errDiv = document.getElementById('error');
      errDiv.textContent = 'حدث خطأ أثناء تحميل البيانات.';
      errDiv.style.display = 'block';
    }
  }

  main();
</script>

</body>
</html>

